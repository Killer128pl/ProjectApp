

--- PLIK: Program.cs ---

using ProjectApp.Abstractions;
using ProjectApp.Console.UI;
using ProjectApp.DataAccess.Memory;
using ProjectApp.DataAccess.Memory.Repositories;
using ProjectApp.Services;

// 1. Inicjalizacja Bazy i Repozytoriów
var db = new MemoryDbContext();
IPackageRepository packageRepo = new PackageRepositoryMemory(db);

// 2. Inicjalizacja Serwisów
var packageSvc = new PackageService(packageRepo);
var logisticsSvc = new LogisticsService(db);

// 3. Seedowanie danych (opcjonalne, ale przydatne)
var seeder = new DataSeeder(packageSvc, db);
seeder.Seed();

// 4. Uruchomienie Menu G³ównego
var mainMenu = new MainMenu(packageSvc, logisticsSvc, db);
mainMenu.Run();


--- PLIK: ConsoleHelpers.cs ---

using System.Globalization;

namespace ProjectApp.Console.Helpers
{
    public static class ConsoleHelpers
    {
        public static void Pause()
        {
            System.Console.WriteLine();
            System.Console.WriteLine("Naciœnij dowolny klawisz, aby kontynuowaæ...");
            System.Console.ReadKey(true);
        }

        public static int ReadIndex(string prompt, int count)
        {
            System.Console.Write(prompt);
            var text = System.Console.ReadLine();

            if (!int.TryParse(text, out int number))
                return -1;

            if (number < 1 || number > count)
                return -1;

            return number - 1;
        }

        public static float ReadFloat(string prompt)
        {
            System.Console.Write(prompt);
            var text = System.Console.ReadLine();
            if (float.TryParse(text, NumberStyles.Any, CultureInfo.InvariantCulture, out float result))
            {
                return result;
            }
            return 0.0f;
        }

        public static string ReadString(string prompt)
        {
            System.Console.Write(prompt);
            return System.Console.ReadLine() ?? string.Empty;
        }
    }
}


--- PLIK: .NETCoreApp,Version=v8.0.AssemblyAttributes.cs ---

// <autogenerated />
using System;
using System.Reflection;
[assembly: global::System.Runtime.Versioning.TargetFrameworkAttribute(".NETCoreApp,Version=v8.0", FrameworkDisplayName = ".NET 8.0")]


--- PLIK: ProjectApp.Console.AssemblyInfo.cs ---

//------------------------------------------------------------------------------
// <auto-generated>
//     Ten kod zostaÅ‚ wygenerowany przez narzÄ™dzie.
//     Wersja wykonawcza:4.0.30319.42000
//
//     Zmiany w tym pliku mogÄ… spowodowaÄ‡ nieprawidÅ‚owe zachowanie i zostanÄ… utracone, jeÅ›li
//     kod zostanie ponownie wygenerowany.
// </auto-generated>
//------------------------------------------------------------------------------

using System;
using System.Reflection;

[assembly: System.Reflection.AssemblyCompanyAttribute("ProjectApp.Console")]
[assembly: System.Reflection.AssemblyConfigurationAttribute("Debug")]
[assembly: System.Reflection.AssemblyFileVersionAttribute("1.0.0.0")]
[assembly: System.Reflection.AssemblyInformationalVersionAttribute("1.0.0+b104179d5fe7966d71626d10142cc9e45a2db13a")]
[assembly: System.Reflection.AssemblyProductAttribute("ProjectApp.Console")]
[assembly: System.Reflection.AssemblyTitleAttribute("ProjectApp.Console")]
[assembly: System.Reflection.AssemblyVersionAttribute("1.0.0.0")]

// Wygenerowane przez klasÄ™ WriteCodeFragment programu MSBuild.



--- PLIK: ProjectApp.Console.GlobalUsings.g.cs ---

// <auto-generated/>
global using global::System;
global using global::System.Collections.Generic;
global using global::System.IO;
global using global::System.Linq;
global using global::System.Net.Http;
global using global::System.Threading;
global using global::System.Threading.Tasks;


--- PLIK: LogisticsMenu.cs ---

using ProjectApp.Console.Helpers;
using ProjectApp.DataAccess.Memory;
using ProjectApp.Services;

namespace ProjectApp.Console.UI
{
    public class LogisticsMenu : MenuBase
    {
        private readonly LogisticsService _logisticsService;
        private readonly MemoryDbContext _db;

        public LogisticsMenu(LogisticsService logisticsService, MemoryDbContext db)
        {
            _logisticsService = logisticsService;
            _db = db;
        }

        protected override string Title => "LOGISTYKA I FLOTA";
        protected override Dictionary<char, MenuOption> Options => new()
        {
            ['1'] = new("Poka¿ pracowników", ShowWorkers),
            ['2'] = new("Poka¿ pojazdy", ShowVehicles),
            ['3'] = new("Przypisz pojazd do kuriera", AssignVehicle),
            ['4'] = new("Wydaj paczkê kurierowi", AssignPackage),
            ['0'] = new("Powrót", null),
        };

        private void ShowWorkers()
        {
            if (!_db.Workers.Any()) System.Console.WriteLine("Brak pracowników.");
            foreach (var w in _db.Workers)
            {
                string autoInfo = w.AssignedVehicleId.HasValue ? $"AutoID: {w.AssignedVehicleId}" : "BRAK AUTA";
                System.Console.WriteLine($"{w.FirstName} {w.LastName} [{w.Position}] - {autoInfo}");
            }
            ConsoleHelpers.Pause();
        }

        private void ShowVehicles()
        {
            if (!_db.Vehicles.Any()) System.Console.WriteLine("Brak pojazdów.");
            foreach (var v in _db.Vehicles)
            {
                System.Console.WriteLine($"{v.Brand} {v.Model} ({v.RegNumber}) - Status: {v.VehicleStatus}");
            }
            ConsoleHelpers.Pause();
        }

        private void AssignVehicle()
        {
            var workers = _db.Workers.ToList();
            var vehicles = _db.Vehicles.ToList();

            if (!workers.Any() || !vehicles.Any())
            {
                System.Console.WriteLine("Brak danych do operacji.");
                ConsoleHelpers.Pause();
                return;
            }

            System.Console.WriteLine("--- PRACOWNICY ---");
            for (int i = 0; i < workers.Count; i++)
                System.Console.WriteLine($"{i + 1}) {workers[i].LastName} ({workers[i].Position})");

            int wIdx = ConsoleHelpers.ReadIndex("Wybierz pracownika: ", workers.Count);
            if (wIdx < 0) return;

            System.Console.WriteLine("\n--- POJAZDY ---");
            for (int i = 0; i < vehicles.Count; i++)
                System.Console.WriteLine($"{i + 1}) {vehicles[i].Brand} {vehicles[i].Model} [{vehicles[i].VehicleStatus}]");

            int vIdx = ConsoleHelpers.ReadIndex("Wybierz pojazd: ", vehicles.Count);
            if (vIdx < 0) return;

            bool success = _logisticsService.AssignVehicleToWorker(workers[wIdx].WorkerId, vehicles[vIdx].VehicleId);
            System.Console.WriteLine(success ? "Przypisano pojazd." : "B³¹d przypisywania (pojazd zajêty lub z³e dane).");
            ConsoleHelpers.Pause();
        }

        private void AssignPackage()
        {
            var packages = _db.Packages.Where(p => p.PackageStatus == DataModel.PackageStatus.Sent).ToList();
            var couriers = _db.Workers.Where(w => w.Position == "Kurier").ToList();

            if (!packages.Any())
            {
                System.Console.WriteLine("Brak paczek oczekuj¹cych na wydanie.");
                ConsoleHelpers.Pause();
                return;
            }
            if (!couriers.Any())
            {
                System.Console.WriteLine("Brak kurierów.");
                ConsoleHelpers.Pause();
                return;
            }

            System.Console.WriteLine("--- PACZKI (SENT) ---");
            for (int i = 0; i < packages.Count; i++)
                System.Console.WriteLine($"{i + 1}) {packages[i].TrackingNumber} ({packages[i].Weight}kg)");

            int pIdx = ConsoleHelpers.ReadIndex("Wybierz paczkê: ", packages.Count);
            if (pIdx < 0) return;

            System.Console.WriteLine("\n--- KURIERZY ---");
            for (int i = 0; i < couriers.Count; i++)
            {
                string auto = couriers[i].AssignedVehicleId.HasValue ? "MA AUTO" : "PIESZY";
                System.Console.WriteLine($"{i + 1}) {couriers[i].LastName} [{auto}]");
            }

            int cIdx = ConsoleHelpers.ReadIndex("Wybierz kuriera: ", couriers.Count);
            if (cIdx < 0) return;

            bool success = _logisticsService.AssignPackageToCourier(packages[pIdx].TrackingNumber, couriers[cIdx].WorkerId);
            System.Console.WriteLine(success ? "Paczka wydana kurierowi." : "B³¹d: Kurier musi mieæ przypisane auto!");
            ConsoleHelpers.Pause();
        }
    }
}


--- PLIK: MainMenu.cs ---

using ProjectApp.DataAccess.Memory;
using ProjectApp.ServiceAbstractions;
using ProjectApp.Services;

namespace ProjectApp.Console.UI
{
    public class MainMenu : MenuBase
    {
        private readonly PackageMenu _packageMenu;
        private readonly LogisticsMenu _logisticsMenu;

        public MainMenu(IPackageService packageSvc, LogisticsService logisticsSvc, MemoryDbContext db)
        {
            _packageMenu = new PackageMenu(packageSvc);
            _logisticsMenu = new LogisticsMenu(logisticsSvc, db);
        }

        protected override string Title => "SYSTEM LOGISTYCZNY - MENU G£ÓWNE";
        protected override Dictionary<char, MenuOption> Options => new()
        {
            ['1'] = new("Obs³uga Paczek", () => _packageMenu.Run()),
            ['2'] = new("Logistyka (Flota i Kurierzy)", () => _logisticsMenu.Run()),
            ['0'] = new("Wyjœcie z systemu", null),
        };
    }
}


--- PLIK: MenuBase.cs ---

using ProjectApp.Console.Helpers;

namespace ProjectApp.Console.UI
{
    public abstract class MenuBase
    {
        protected abstract string Title { get; }
        protected abstract Dictionary<char, MenuOption> Options { get; }

        public void Run()
        {
            while (true)
            {
                System.Console.Clear();
                System.Console.WriteLine($"=== {Title} ===\n");

                foreach (var kv in Options)
                    System.Console.WriteLine($"{kv.Key}) {kv.Value.Description}");

                System.Console.Write("\nWybierz opcjê: ");
                var key = System.Console.ReadKey();
                System.Console.WriteLine();

                if (!Options.ContainsKey(key.KeyChar))
                {
                    System.Console.WriteLine("Nieznana opcja.");
                    ConsoleHelpers.Pause();
                    continue;
                }

                var option = Options[key.KeyChar];
                if (option.Action == null)
                    return;

                option.Action();
            }
        }
    }
}


--- PLIK: MenuOption.cs ---

namespace ProjectApp.Console.UI
{
    public record MenuOption(string Description, Action? Action);
}


--- PLIK: PackageMenu.cs ---

using ProjectApp.Abstractions;
using ProjectApp.Console.Helpers;
using ProjectApp.DataModel;
using ProjectApp.ServiceAbstractions;

namespace ProjectApp.Console.UI
{
    public class PackageMenu : MenuBase
    {
        private readonly IPackageService _packageService;

        public PackageMenu(IPackageService packageService)
        {
            _packageService = packageService;
        }

        protected override string Title => "ZARZ¥DZANIE PACZKAMI";
        protected override Dictionary<char, MenuOption> Options => new()
        {
            ['1'] = new("Lista wszystkich paczek", ShowAllPackages),
            ['2'] = new("Nadaj now¹ paczkê", CreatePackage),
            ['3'] = new("Zmieñ status paczki", UpdateStatus),
            ['0'] = new("Powrót", null),
        };

        private void ShowAllPackages()
        {
            var packages = _packageService.GetAll();
            if (!packages.Any())
            {
                System.Console.WriteLine("Brak paczek w systemie.");
                ConsoleHelpers.Pause();
                return;
            }

            foreach (var p in packages)
            {
                System.Console.WriteLine(p.ToString());
            }
            ConsoleHelpers.Pause();
        }

        private void CreatePackage()
        {
            float weight = ConsoleHelpers.ReadFloat("Podaj wagê (kg): ");
            string size = ConsoleHelpers.ReadString("Podaj rozmiar (Small/Medium/Big): ");

            var id = Guid.NewGuid();
            _packageService.CreatePackage(id, DateTime.Now, weight, size);

            System.Console.WriteLine($"Paczka nadana! Numer œledzenia: {id}");
            ConsoleHelpers.Pause();
        }

        private void UpdateStatus()
        {
            var packages = _packageService.GetAll().ToList();
            if (!packages.Any())
            {
                System.Console.WriteLine("Brak paczek.");
                ConsoleHelpers.Pause();
                return;
            }

            for (int i = 0; i < packages.Count; i++)
            {
                System.Console.WriteLine($"{i + 1}) {packages[i]}");
            }

            int idx = ConsoleHelpers.ReadIndex($"Wybierz paczkê (1..{packages.Count}): ", packages.Count);
            if (idx < 0) return;

            System.Console.WriteLine("Dostêpne statusy: 0-Sent, 1-InTransit, 2-Delivered, 3-Damaged");
            int statusInt = (int)ConsoleHelpers.ReadFloat("Podaj numer statusu: ");

            if (statusInt >= 0 && statusInt <= 3)
            {
                _packageService.UpdatePackageStatus(packages[idx].TrackingNumber, (PackageStatus)statusInt);
                System.Console.WriteLine("Status zaktualizowany.");
            }
            else
            {
                System.Console.WriteLine("Niepoprawny status.");
            }
            ConsoleHelpers.Pause();
        }
    }
}


--- PLIK: Class1.cs ---

namespace ProjectApp.Abstractions
{
    public class Class1
    {

    }
}


--- PLIK: IPackageRepository.cs ---

using ProjectApp.DataModel;

namespace ProjectApp.Abstractions
{
    public interface IPackageRepository
    {
        IQueryable<Package> Query();
        Package? Get(Guid id);
        void Add(Package entity);
        void Remove(Package entity);
        IEnumerable<Package> GetAll();
    }
}


--- PLIK: .NETCoreApp,Version=v8.0.AssemblyAttributes.cs ---

// <autogenerated />
using System;
using System.Reflection;
[assembly: global::System.Runtime.Versioning.TargetFrameworkAttribute(".NETCoreApp,Version=v8.0", FrameworkDisplayName = ".NET 8.0")]


--- PLIK: ProjectApp.Abstractions.AssemblyInfo.cs ---

//------------------------------------------------------------------------------
// <auto-generated>
//     Ten kod zostaÅ‚ wygenerowany przez narzÄ™dzie.
//     Wersja wykonawcza:4.0.30319.42000
//
//     Zmiany w tym pliku mogÄ… spowodowaÄ‡ nieprawidÅ‚owe zachowanie i zostanÄ… utracone, jeÅ›li
//     kod zostanie ponownie wygenerowany.
// </auto-generated>
//------------------------------------------------------------------------------

using System;
using System.Reflection;

[assembly: System.Reflection.AssemblyCompanyAttribute("ProjectApp.Abstractions")]
[assembly: System.Reflection.AssemblyConfigurationAttribute("Debug")]
[assembly: System.Reflection.AssemblyFileVersionAttribute("1.0.0.0")]
[assembly: System.Reflection.AssemblyInformationalVersionAttribute("1.0.0+b104179d5fe7966d71626d10142cc9e45a2db13a")]
[assembly: System.Reflection.AssemblyProductAttribute("ProjectApp.Abstractions")]
[assembly: System.Reflection.AssemblyTitleAttribute("ProjectApp.Abstractions")]
[assembly: System.Reflection.AssemblyVersionAttribute("1.0.0.0")]

// Wygenerowane przez klasÄ™ WriteCodeFragment programu MSBuild.



--- PLIK: ProjectApp.Abstractions.GlobalUsings.g.cs ---

// <auto-generated/>
global using global::System;
global using global::System.Collections.Generic;
global using global::System.IO;
global using global::System.Linq;
global using global::System.Net.Http;
global using global::System.Threading;
global using global::System.Threading.Tasks;


--- PLIK: MemoryDbContext.cs ---

using ProjectApp.DataModel;

namespace ProjectApp.DataAccess.Memory
{
    public class MemoryDbContext
    {
        public List<Package> Packages { get; } = new();
        public List<Worker> Workers { get; } = new();
        public List<Vehicle> Vehicles { get; } = new();
        public List<Client> Clients { get; } = new();
        public List<Storage> Storages { get; } = new();
    }
}


--- PLIK: UnitOfWorkMemory.cs ---

using System;
using System.Collections.Generic;
using System.Linq;
using System.Text;
using System.Threading.Tasks;

namespace ProjectApp.DataAccess.Memory
{
    internal class UnitOfWorkMemory
    {
    }
}


--- PLIK: .NETCoreApp,Version=v8.0.AssemblyAttributes.cs ---

// <autogenerated />
using System;
using System.Reflection;
[assembly: global::System.Runtime.Versioning.TargetFrameworkAttribute(".NETCoreApp,Version=v8.0", FrameworkDisplayName = ".NET 8.0")]


--- PLIK: ProjectApp.DataAccess.Memory.AssemblyInfo.cs ---

//------------------------------------------------------------------------------
// <auto-generated>
//     Ten kod zostaÅ‚ wygenerowany przez narzÄ™dzie.
//     Wersja wykonawcza:4.0.30319.42000
//
//     Zmiany w tym pliku mogÄ… spowodowaÄ‡ nieprawidÅ‚owe zachowanie i zostanÄ… utracone, jeÅ›li
//     kod zostanie ponownie wygenerowany.
// </auto-generated>
//------------------------------------------------------------------------------

using System;
using System.Reflection;

[assembly: System.Reflection.AssemblyCompanyAttribute("ProjectApp.DataAccess.Memory")]
[assembly: System.Reflection.AssemblyConfigurationAttribute("Debug")]
[assembly: System.Reflection.AssemblyFileVersionAttribute("1.0.0.0")]
[assembly: System.Reflection.AssemblyInformationalVersionAttribute("1.0.0+b104179d5fe7966d71626d10142cc9e45a2db13a")]
[assembly: System.Reflection.AssemblyProductAttribute("ProjectApp.DataAccess.Memory")]
[assembly: System.Reflection.AssemblyTitleAttribute("ProjectApp.DataAccess.Memory")]
[assembly: System.Reflection.AssemblyVersionAttribute("1.0.0.0")]

// Wygenerowane przez klasÄ™ WriteCodeFragment programu MSBuild.



--- PLIK: ProjectApp.DataAccess.Memory.GlobalUsings.g.cs ---

// <auto-generated/>
global using global::System;
global using global::System.Collections.Generic;
global using global::System.IO;
global using global::System.Linq;
global using global::System.Net.Http;
global using global::System.Threading;
global using global::System.Threading.Tasks;


--- PLIK: PackageRepositoryMemory.cs ---

using ProjectApp.Abstractions;
using ProjectApp.DataModel;

namespace ProjectApp.DataAccess.Memory.Repositories
{
    public class PackageRepositoryMemory : IPackageRepository
    {
        private readonly MemoryDbContext _db;

        public PackageRepositoryMemory(MemoryDbContext db) => _db = db;

        public IQueryable<Package> Query() => _db.Packages.AsQueryable();

        public Package? Get(Guid id) => _db.Packages.FirstOrDefault(p => p.TrackingNumber == id);

        public void Add(Package entity) => _db.Packages.Add(entity);

        public void Remove(Package entity) => _db.Packages.Remove(entity);

        public IEnumerable<Package> GetAll() => _db.Packages;
    }
}


--- PLIK: Client.cs ---

namespace ProjectApp.DataModel
{
    public class Client : PersonalData
    {
        public Guid ClientId { get; set; } = Guid.NewGuid();
    }
}


--- PLIK: Package.cs ---

namespace ProjectApp.DataModel
{
    public class Package
    {
        public Guid TrackingNumber { get; set; }
        public DateTime SentDate { get; set; }
        public float Weight { get; set; }
        public string? Size { get; set; }
        public PackageStatus PackageStatus { get; set; }
        public PaymentStatus PaymentStatus { get; set; }
        public Guid? AssignedWorkerId { get; set; }

        public override string ToString()
        {
            return $"Numer: {TrackingNumber} | Status: {PackageStatus} | Waga: {Weight}kg | KurierID: {(AssignedWorkerId.HasValue ? AssignedWorkerId.ToString() : "Brak")}";
        }
    }
}


--- PLIK: PersonalData.cs ---

namespace ProjectApp.DataModel
{
    public class PersonalData
    {
        public string? FirstName { get; set; }
        public string? LastName { get; set; }
        public string? Address { get; set; }
        public int PhoneNumber { get; set; }
        public string? Email { get; set; }
    }
}


--- PLIK: Statuses.cs ---

namespace ProjectApp.DataModel
{
    public enum PackageStatus
    {
        Sent,
        InTransit,
        Delivered,
        Damaged
    }

    public enum PaymentStatus
    {
        Paid,
        NotPaid,
        OnDeliveryPayment
    }
}


--- PLIK: Storage.cs ---

namespace ProjectApp.DataModel
{
    public class Storage
    {
        public Guid StorageId { get; set; } = Guid.NewGuid();
        public string Name { get; set; } = "Main Storage";
        public List<Package> StoredPackages { get; set; } = new();
    }
}


--- PLIK: Vehicle.cs ---

namespace ProjectApp.DataModel
{
    public class Vehicle
    {
        public Guid VehicleId { get; set; } = Guid.NewGuid();
        public string? Brand { get; set; }
        public string? Model { get; set; }
        public string? RegNumber { get; set; }
        public string VehicleStatus { get; set; } = "Available";
    }
}


--- PLIK: Worker.cs ---

namespace ProjectApp.DataModel
{
    public class Worker : PersonalData
    {
        public Guid WorkerId { get; set; } = Guid.NewGuid();
        public string? Position { get; set; }
        public Guid? AssignedVehicleId { get; set; }
    }
}


--- PLIK: .NETCoreApp,Version=v8.0.AssemblyAttributes.cs ---

// <autogenerated />
using System;
using System.Reflection;
[assembly: global::System.Runtime.Versioning.TargetFrameworkAttribute(".NETCoreApp,Version=v8.0", FrameworkDisplayName = ".NET 8.0")]


--- PLIK: ProjectApp.DataModel.AssemblyInfo.cs ---

//------------------------------------------------------------------------------
// <auto-generated>
//     Ten kod zostaÅ‚ wygenerowany przez narzÄ™dzie.
//     Wersja wykonawcza:4.0.30319.42000
//
//     Zmiany w tym pliku mogÄ… spowodowaÄ‡ nieprawidÅ‚owe zachowanie i zostanÄ… utracone, jeÅ›li
//     kod zostanie ponownie wygenerowany.
// </auto-generated>
//------------------------------------------------------------------------------

using System;
using System.Reflection;

[assembly: System.Reflection.AssemblyCompanyAttribute("ProjectApp.DataModel")]
[assembly: System.Reflection.AssemblyConfigurationAttribute("Debug")]
[assembly: System.Reflection.AssemblyFileVersionAttribute("1.0.0.0")]
[assembly: System.Reflection.AssemblyInformationalVersionAttribute("1.0.0+b104179d5fe7966d71626d10142cc9e45a2db13a")]
[assembly: System.Reflection.AssemblyProductAttribute("ProjectApp.DataModel")]
[assembly: System.Reflection.AssemblyTitleAttribute("ProjectApp.DataModel")]
[assembly: System.Reflection.AssemblyVersionAttribute("1.0.0.0")]

// Wygenerowane przez klasÄ™ WriteCodeFragment programu MSBuild.



--- PLIK: ProjectApp.DataModel.GlobalUsings.g.cs ---

// <auto-generated/>
global using global::System;
global using global::System.Collections.Generic;
global using global::System.IO;
global using global::System.Linq;
global using global::System.Net.Http;
global using global::System.Threading;
global using global::System.Threading.Tasks;


--- PLIK: IDataSeeder.cs ---

using System;
using System.Collections.Generic;
using System.Linq;
using System.Text;
using System.Threading.Tasks;

namespace ProjectApp.ServiceAbstractions
{
    public interface IDataSeeder
    {
        SeedResult Seed();
    }
    public sealed class SeedResult
    {
        public Guid pckg1 { get; init; }
        public Guid pckg2 { get; init; }
        public Guid pckg3 { get; init; }
    }
}


--- PLIK: IPackageService.cs ---

using ProjectApp.DataModel;

namespace ProjectApp.ServiceAbstractions
{
    public interface IPackageService
    {
        bool UpdatePackageStatus(Guid trackingNumber, PackageStatus status);

        bool UpdatePaymentStatus(Guid trackingNumber, PaymentStatus status);

        public Guid CreatePackage(Guid trackingNumber, DateTime sentDate, float weight, string size);

        IReadOnlyList<Package> GetAll();

        IEnumerable<Package> Search(Guid trackingNumber);
    }
}


--- PLIK: .NETCoreApp,Version=v8.0.AssemblyAttributes.cs ---

// <autogenerated />
using System;
using System.Reflection;
[assembly: global::System.Runtime.Versioning.TargetFrameworkAttribute(".NETCoreApp,Version=v8.0", FrameworkDisplayName = ".NET 8.0")]


--- PLIK: ProjectApp.ServiceAbstractions.AssemblyInfo.cs ---

//------------------------------------------------------------------------------
// <auto-generated>
//     Ten kod zostaÅ‚ wygenerowany przez narzÄ™dzie.
//     Wersja wykonawcza:4.0.30319.42000
//
//     Zmiany w tym pliku mogÄ… spowodowaÄ‡ nieprawidÅ‚owe zachowanie i zostanÄ… utracone, jeÅ›li
//     kod zostanie ponownie wygenerowany.
// </auto-generated>
//------------------------------------------------------------------------------

using System;
using System.Reflection;

[assembly: System.Reflection.AssemblyCompanyAttribute("ProjectApp.ServiceAbstractions")]
[assembly: System.Reflection.AssemblyConfigurationAttribute("Debug")]
[assembly: System.Reflection.AssemblyFileVersionAttribute("1.0.0.0")]
[assembly: System.Reflection.AssemblyInformationalVersionAttribute("1.0.0+b104179d5fe7966d71626d10142cc9e45a2db13a")]
[assembly: System.Reflection.AssemblyProductAttribute("ProjectApp.ServiceAbstractions")]
[assembly: System.Reflection.AssemblyTitleAttribute("ProjectApp.ServiceAbstractions")]
[assembly: System.Reflection.AssemblyVersionAttribute("1.0.0.0")]

// Wygenerowane przez klasÄ™ WriteCodeFragment programu MSBuild.



--- PLIK: ProjectApp.ServiceAbstractions.GlobalUsings.g.cs ---

// <auto-generated/>
global using global::System;
global using global::System.Collections.Generic;
global using global::System.IO;
global using global::System.Linq;
global using global::System.Net.Http;
global using global::System.Threading;
global using global::System.Threading.Tasks;


--- PLIK: DataSeeder.cs ---

using ProjectApp.DataAccess.Memory;
using ProjectApp.DataModel;
using ProjectApp.ServiceAbstractions;

namespace ProjectApp.Services
{
    public class DataSeeder : IDataSeeder
    {
        private readonly IPackageService _packageService;
        private readonly MemoryDbContext _db;

        public DataSeeder(IPackageService packageService, MemoryDbContext db)
        {
            _packageService = packageService;
            _db = db;
        }

        public SeedResult Seed()
        {
            var pckg1 = _packageService.CreatePackage(Guid.NewGuid(), DateTime.Now, 2.5f, "Big");
            var pckg2 = _packageService.CreatePackage(Guid.Parse("21372137-2137-2137-2137-213721372137"), DateTime.Now.AddDays(-1), 1.0f, "Small");
            var pckg3 = _packageService.CreatePackage(Guid.NewGuid(), DateTime.Now.AddDays(-2), 5.0f, "Huge");

            _db.Vehicles.Add(new Vehicle { Brand = "Ford", Model = "Transit", RegNumber = "WA 12345", VehicleStatus = "Available" });
            _db.Workers.Add(new Worker { FirstName = "Jan", LastName = "Kowalski", Position = "Kurier" });
            _db.Workers.Add(new Worker { FirstName = "Adam", LastName = "Nowak", Position = "Magazynier" });

            return new SeedResult { pckg1 = pckg1, pckg2 = pckg2, pckg3 = pckg3 };
        }
    }
}


--- PLIK: LogisticsService.cs ---

using ProjectApp.DataAccess.Memory;
using ProjectApp.DataModel;

namespace ProjectApp.Services
{
    public class LogisticsService
    {
        private readonly MemoryDbContext _db;

        public LogisticsService(MemoryDbContext db)
        {
            _db = db;
        }

        public bool AssignVehicleToWorker(Guid workerId, Guid vehicleId)
        {
            var worker = _db.Workers.FirstOrDefault(w => w.WorkerId == workerId);
            var vehicle = _db.Vehicles.FirstOrDefault(v => v.VehicleId == vehicleId);

            if (worker == null || vehicle == null) return false;

            if (vehicle.VehicleStatus != "Available") return false;

            worker.AssignedVehicleId = vehicle.VehicleId;
            vehicle.VehicleStatus = "InUse";

            return true;
        }

        public bool AssignPackageToCourier(Guid packageId, Guid workerId)
        {
            var package = _db.Packages.FirstOrDefault(p => p.TrackingNumber == packageId);
            var worker = _db.Workers.FirstOrDefault(w => w.WorkerId == workerId);

            if (package == null || worker == null) return false;

            if (worker.Position != "Kurier" || worker.AssignedVehicleId == null) return false;

            package.AssignedWorkerId = worker.WorkerId;
            package.PackageStatus = PackageStatus.InTransit;

            return true;
        }
    }
}


--- PLIK: PackageService.cs ---

using ProjectApp.Abstractions;
using ProjectApp.DataModel;
using ProjectApp.ServiceAbstractions;

namespace ProjectApp.Services
{
    public class PackageService : IPackageService
    {
        private readonly IPackageRepository _packages;

        public PackageService(IPackageRepository packages)
        {
            _packages = packages;
        }

        public Guid CreatePackage(Guid trackingNumber, DateTime sentDate, float weight, string size)
        {
            var package = new Package
            {
                TrackingNumber = trackingNumber,
                SentDate = sentDate,
                Weight = weight,
                Size = size,
                PackageStatus = PackageStatus.Sent
            };

            _packages.Add(package);
            return package.TrackingNumber;
        }

        public IReadOnlyList<Package> GetAll()
        {
            return _packages.Query().OrderBy(m => m.SentDate).ToList();
        }

        public IEnumerable<Package> Search(Guid trackingNumber)
        {
            return _packages.GetAll().Where(p => p.TrackingNumber == trackingNumber);
        }

        public Package? Get(Guid trackingNumber)
        {
            return _packages.Get(trackingNumber);
        }

        public bool UpdatePackageStatus(Guid trackingNumber, PackageStatus status)
        {
            var m = _packages.Get(trackingNumber);
            if (m is null) return false;
            m.PackageStatus = status;
            return true;
        }

        public bool UpdatePaymentStatus(Guid trackingNumber, PaymentStatus status)
        {
            var m = _packages.Get(trackingNumber);
            if (m is null) return false;
            m.PaymentStatus = status;
            return true;
        }
    }
}


--- PLIK: .NETCoreApp,Version=v8.0.AssemblyAttributes.cs ---

// <autogenerated />
using System;
using System.Reflection;
[assembly: global::System.Runtime.Versioning.TargetFrameworkAttribute(".NETCoreApp,Version=v8.0", FrameworkDisplayName = ".NET 8.0")]


--- PLIK: ProjectApp.Services.AssemblyInfo.cs ---

//------------------------------------------------------------------------------
// <auto-generated>
//     Ten kod zostaÅ‚ wygenerowany przez narzÄ™dzie.
//     Wersja wykonawcza:4.0.30319.42000
//
//     Zmiany w tym pliku mogÄ… spowodowaÄ‡ nieprawidÅ‚owe zachowanie i zostanÄ… utracone, jeÅ›li
//     kod zostanie ponownie wygenerowany.
// </auto-generated>
//------------------------------------------------------------------------------

using System;
using System.Reflection;

[assembly: System.Reflection.AssemblyCompanyAttribute("ProjectApp.Services")]
[assembly: System.Reflection.AssemblyConfigurationAttribute("Debug")]
[assembly: System.Reflection.AssemblyFileVersionAttribute("1.0.0.0")]
[assembly: System.Reflection.AssemblyInformationalVersionAttribute("1.0.0+b104179d5fe7966d71626d10142cc9e45a2db13a")]
[assembly: System.Reflection.AssemblyProductAttribute("ProjectApp.Services")]
[assembly: System.Reflection.AssemblyTitleAttribute("ProjectApp.Services")]
[assembly: System.Reflection.AssemblyVersionAttribute("1.0.0.0")]

// Wygenerowane przez klasÄ™ WriteCodeFragment programu MSBuild.



--- PLIK: ProjectApp.Services.GlobalUsings.g.cs ---

// <auto-generated/>
global using global::System;
global using global::System.Collections.Generic;
global using global::System.IO;
global using global::System.Linq;
global using global::System.Net.Http;
global using global::System.Threading;
global using global::System.Threading.Tasks;


--- PLIK: InMemoryServicesFixture.cs ---

using ProjectApp.DataAccess.Memory;
using ProjectApp.DataAccess.Memory.Repositories;
using ProjectApp.Abstractions;
using ProjectApp.Services;
using ProjectApp.ServiceAbstractions;

public class InMemoryServicesFixture
{
    private DataSeeder _dataSeeder;
    public IPackageService PackageService { get; }

    public InMemoryServicesFixture()
    {
        var db = new MemoryDbContext();

        IPackageRepository packageRepo = new PackageRepositoryMemory(db);

        _dataSeeder = new DataSeeder(PackageService);
        _dataSeeder.Seed();
    }
}


--- PLIK: LogisticsServiceTests.cs ---

using ProjectApp.DataAccess.Memory;
using ProjectApp.DataModel;
using ProjectApp.Services;
using Xunit;

public class LogisticsServiceTests
{
    [Fact]
    public void AssignPackageToCourier_ShouldFail_IfWorkerHasNoVehicle()
    {
        var db = new MemoryDbContext();
        var service = new LogisticsService(db);

        var worker = new Worker { WorkerId = Guid.NewGuid(), Position = "Kurier" };
        var package = new Package { TrackingNumber = Guid.NewGuid(), PackageStatus = PackageStatus.Sent };

        db.Workers.Add(worker);
        db.Packages.Add(package);

        var result = service.AssignPackageToCourier(package.TrackingNumber, worker.WorkerId);

        Assert.False(result);
        Assert.Equal(PackageStatus.Sent, package.PackageStatus);
    }

    [Fact]
    public void AssignPackageToCourier_ShouldSuccess_IfWorkerHasVehicle()
    {
        var db = new MemoryDbContext();
        var service = new LogisticsService(db);

        var vehicle = new Vehicle { VehicleId = Guid.NewGuid(), VehicleStatus = "Available" };
        var worker = new Worker { WorkerId = Guid.NewGuid(), Position = "Kurier", AssignedVehicleId = vehicle.VehicleId };
        var package = new Package { TrackingNumber = Guid.NewGuid(), PackageStatus = PackageStatus.Sent };

        db.Vehicles.Add(vehicle);
        db.Workers.Add(worker);
        db.Packages.Add(package);

        var result = service.AssignPackageToCourier(package.TrackingNumber, worker.WorkerId);

        Assert.True(result);
        Assert.Equal(PackageStatus.InTransit, package.PackageStatus);
        Assert.Equal(worker.WorkerId, package.AssignedWorkerId);
    }
}


--- PLIK: PackageServiceTests.cs ---

using ProjectApp.ServiceAbstractions;
using Xunit;

public class PackageServiceTest : IClassFixture<InMemoryServicesFixture>
{
    private readonly IPackageService _packageService;

    public PackageServiceTest(InMemoryServicesFixture fx)
    {
        _packageService = fx.PackageService;

    }
    [Fact]
    public void Search_ShouldFindPackage2137()
    {
        var id = Guid.Parse("2137");
        var results = _packageService.Search(id);
        Assert.Contains(results, p => p.TrackingNumber == id);
    }
}


--- PLIK: .NETCoreApp,Version=v8.0.AssemblyAttributes.cs ---

// <autogenerated />
using System;
using System.Reflection;
[assembly: global::System.Runtime.Versioning.TargetFrameworkAttribute(".NETCoreApp,Version=v8.0", FrameworkDisplayName = ".NET 8.0")]


--- PLIK: ProjectApp.Test.AssemblyInfo.cs ---

//------------------------------------------------------------------------------
// <auto-generated>
//     Ten kod zostaÅ‚ wygenerowany przez narzÄ™dzie.
//     Wersja wykonawcza:4.0.30319.42000
//
//     Zmiany w tym pliku mogÄ… spowodowaÄ‡ nieprawidÅ‚owe zachowanie i zostanÄ… utracone, jeÅ›li
//     kod zostanie ponownie wygenerowany.
// </auto-generated>
//------------------------------------------------------------------------------

using System;
using System.Reflection;

[assembly: System.Reflection.AssemblyCompanyAttribute("ProjectApp.Test")]
[assembly: System.Reflection.AssemblyConfigurationAttribute("Debug")]
[assembly: System.Reflection.AssemblyFileVersionAttribute("1.0.0.0")]
[assembly: System.Reflection.AssemblyInformationalVersionAttribute("1.0.0+b104179d5fe7966d71626d10142cc9e45a2db13a")]
[assembly: System.Reflection.AssemblyProductAttribute("ProjectApp.Test")]
[assembly: System.Reflection.AssemblyTitleAttribute("ProjectApp.Test")]
[assembly: System.Reflection.AssemblyVersionAttribute("1.0.0.0")]

// Wygenerowane przez klasÄ™ WriteCodeFragment programu MSBuild.



--- PLIK: ProjectApp.Test.GlobalUsings.g.cs ---

// <auto-generated/>
global using global::System;
global using global::System.Collections.Generic;
global using global::System.IO;
global using global::System.Linq;
global using global::System.Net.Http;
global using global::System.Threading;
global using global::System.Threading.Tasks;
global using global::Xunit;
